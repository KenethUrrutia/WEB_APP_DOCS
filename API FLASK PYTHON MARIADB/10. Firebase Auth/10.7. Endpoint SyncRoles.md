
Este es un endpoint que utilizará el frontend para sincronizar los roles cuando se inicie sesión.

```python
from flask_restx import Resource
from flask import request
from src.common.utils import db, api, ErrorResponseModel
from src.features.users.user_service import UserService
from src.features.users.user_doc import (
    UserResponseDoc,
    UserAddRoleDoc
)
from sqlalchemy.exc import NoResultFound, OperationalError
from firebase_admin import auth
from src.security.firebase_required import firebase_role_required
import logging
logger = logging.getLogger(__name__)

class UserRoleSyncController(Resource):
    @api.doc(description='Sincroniza los roles de un usuario con su token', security='Bearer')
    @api.response(204, 'Roles sincronizados')
    @api.response(404, 'Usuario no encontrado', ErrorResponseModel)
    @api.response(500, 'Error interno', ErrorResponseModel)
    @firebase_role_required()
    def post(self):
        """Sincroniza los roles de un usuario con su token"""
        try:
            uid = auth.verify_id_token(request.headers['Authorization'].split()[1])['uid']
            
            user_response, status = UserService.get_user_by_uid(uid)
            if status == 404:
                return user_response, status
            
            roles = [role['name'] for role in user_response.get('roles', [])]
            claims = {"roles": roles}  # roles = ["admin", "editor", ...]
            auth.set_custom_user_claims(uid, claims)
            user = auth.get_user(uid)
            print(user.custom_claims)
            
            return {'message': 'Roles sincronizados en token'}, 204
        except Exception as err:
            db.session.rollback()
            logger.critical(f"Error inesperado: {str(err)}")
            return {"message": f"Error interno del servidor {str(err)}"}, 500
```